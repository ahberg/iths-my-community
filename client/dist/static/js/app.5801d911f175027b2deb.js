webpackJsonp([1],{"2Jc9":function(t,e){},"4ZZk":function(t,e){},"4bL4":function(t,e){},"96Oq":function(t,e){},DN7r:function(t,e){},E2CX:function(t,e){},F7mj:function(t,e){},Kac5:function(t,e){},NHnr:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=s("7+uW"),r={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{attrs:{id:"app"}},[e("router-view",{attrs:{name:"TopNavBar"}}),this._v(" "),e("router-view")],1)},staticRenderFns:[]};var a=s("VU/8")({name:"App"},r,!1,function(t){s("SuMS")},null,null).exports,o=s("/ocq"),i=s("NYxO"),c=s("PJh5"),l=s.n(c),u=s("mtWM"),d=s.n(u);var p={login:async function(t){let e;try{e=await d.a.post("/api/user/login",t)}catch(t){return{res:{success:!1,errMsg:t},token:null}}return d.a.defaults.headers.common.Authorization=e.data.token,{res:e.data,token:e.data.token}},regist:async function(t){let e;try{e=await d.a.post("/api/user/",t)}catch(t){return console.log(t.response.data),{res:{success:!1,message:t.response.data.message},token:null}}return{res:e.data,token:e.headers["x-auth"]}},checkAuth:async function(t){let e;d.a.defaults.headers.common.Authorization=t;try{e=await d()({method:"get",url:"/api/user/info"})}catch(t){return{res:{success:!1,errMsg:"error1"},token:null}}return d.a.defaults.headers.common.Authorization=e.data.token,{res:e.data,token:e.data.token}}};var v={state:{isAuthChecked:!1,user:null,authToken:null,loginTime:null,maxDurationTime:l.a.duration(36e5).asHours()},getters:{isLogin:t=>!!t.user,isAuthChecked:t=>!!t.isAuthChecked,isInMaxDurationTime:t=>()=>l.a.duration(l()().diff(t.loginTime)).asHours()<t.maxDurationTime,userID:t=>t.user&&t.user.id,userAccount:t=>t.user&&t.user.username,userFollowing:t=>t.user&&t.user.following,authToken:t=>t.authToken},actions:{regist:async({commit:t},e)=>{if(!(e.name&&e.username&&e.password&&e.password2))return{errMsg:"Empty fields",result:!1};let{res:s,token:n}=await p.regist(e);return s},login:async({commit:t},e)=>{if(!e.username||!e.password)return{errMsg:"No username or password",result:!1};let{res:s,token:n}=await p.login(e);return s.success&&(t("setUser",s.user),t("setAuthToken",n),t("setLoginTime",l()()),window.localStorage.setItem("AuthToken",n),console.log("save token"+n)),s},logout:({commit:t})=>{window.localStorage.removeItem("AuthToken"),t("setUser",null),t("setAuthToken",null),t("setLoginTime",null)},checkAuth:async({commit:t})=>{t("setIsAuthChecked",!0);let e=window.localStorage.getItem("AuthToken");if(!e)return{success:!1,errMsg:"No Auth Token"};let{res:s,token:n}=await p.checkAuth(e);return s.success?(console.log("valid token"),window.localStorage.setItem("AuthToken",n),t("setUser",s.user),t("setAuthToken",n),t("setLoginTime",l()())):(t("setUser",null),t("setAuthToken",null),t("setLoginTime",null)),s}},mutations:{setUser:(t,e)=>{t.user=e},setIsAuthChecked:(t,e)=>{t.isAuthChecked=e},setAuthToken:(t,e)=>{t.authToken=e},setLoginTime:(t,e)=>{t.loginTime=e}}};n.a.use(i.a);var m=new i.a.Store({modules:{Auth:v}}),f={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"Home"},[s("div",{staticClass:"HomePageInfo"},[s("svg",{staticClass:"twitterIcon-bird",attrs:{viewBox:"0 0 1208 982",version:"1.1",xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink"}},[s("desc",[t._v("Created with Sketch.")]),t._v(" "),s("defs"),t._v(" "),s("g",{attrs:{id:"Final-Horizon",stroke:"none","stroke-width":"1",fill:"none","fill-rule":"evenodd"}},[s("g",{attrs:{id:"Artboard",transform:"translate(-286.000000, -117.000000)","fill-rule":"nonzero",fill:"#1B95E0"}},[s("path",{attrs:{d:"M1493.75308,233.195911 C1449.31783,252.922544 1401.56126,266.207828 1351.43951,272.19627 C1402.61804,241.549536 1441.92034,192.987798 1460.3889,135.116296 C1412.53168,163.498493 1359.49119,184.130942 1303.02874,195.252335 C1257.88897,147.093181 1193.42514,117 1122.16771,117 C962.190754,117 844.636121,266.258151 880.768067,421.202806 C674.896491,410.886582 492.324484,312.253414 370.089808,162.341063 C305.17308,273.705962 336.423691,419.391176 446.731805,493.16476 C406.171431,491.856361 367.925917,480.734968 334.561738,462.165765 C331.844294,576.95263 414.122472,684.342008 533.287442,708.245454 C498.413572,717.706186 460.218381,719.9204 421.368991,712.47259 C452.871217,810.904465 544.358512,882.514158 652.854997,884.52708 C548.686294,966.201382 417.443793,1002.68559 286,987.186091 C395.653915,1057.48739 525.940278,1098.50067 665.838342,1098.50067 C1125.89162,1098.50067 1385.81015,709.956437 1370.10936,361.469352 C1418.52012,326.494836 1460.53987,282.864756 1493.75308,233.195911 Z",id:"bird"}})])])]),t._v(" "),t._m(0)]),t._v(" "),s("div",{staticClass:"HomePageOperation"},[s("div",{staticClass:"OperactionContainer"},[t._m(1),t._v(" "),s("div",{staticClass:"OperactionBtns"},[s("div",{staticClass:"RegisterTitle"}),t._v(" "),s("router-link",{staticClass:"btn regist",attrs:{to:"/regist",href:"/regist"}},[t._v("\n          Create account\n        ")]),t._v(" "),s("router-link",{staticClass:"btn login",attrs:{to:"/login",href:"/login"}},[t._v("\n          Sign in\n        ")])],1)])])])},staticRenderFns:[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"InfoContainer"},[s("div",{staticClass:"InfoContent"},[s("div",{},[s("span",[s("i",{staticClass:"fas fa-search"})]),t._v(" "),s("span",[t._v("Search")])]),t._v(" "),s("div",{},[s("span",[s("i",{staticClass:"fas fa-users"})]),t._v(" "),s("span",[t._v(" Users")])]),t._v(" "),s("div",{},[s("span",[s("i",{staticClass:"far fa-comment"})]),t._v(" "),s("span",[t._v("Posts")])])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"OperactionDesc"},[e("div",{staticClass:"BirdImg"}),this._v(" "),e("div",{staticClass:"Title"},[this._v("\n          My community\n        ")])])}]};var h=s("VU/8")({name:"Home"},f,!1,function(t){s("4bL4")},"data-v-ea792328",null).exports,g=s("Xxa5"),C=s.n(g),_=s("exGp"),w=s.n(_),P={name:"ErrorMessageBar",props:["text","displayTime"],computed:{timeout:function(){return Number(this.displayTime)?Number(this.displayTime):null}},created:function(){this.timeout&&this.startTimeToClose()},methods:{startTimeToClose:function(){var t=this;this.timeout&&setTimeout(function(){t.$emit("close")},this.timeout)}}},x={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"ErrorMessageBarContainer"},[this.text?e("div",{staticClass:"alert alert-danger"},[this._v("\n    "+this._s(this.text)+"\n  ")]):this._e()])},staticRenderFns:[]};var k=s("VU/8")(P,x,!1,function(t){s("Oj8z")},"data-v-6e5e8b0a",null).exports;var b={follow:async function(t){let e,s=m.getters.authToken;try{e=await d()({methods:"get",url:`/API/user/follow/${t}`,headers:{"x-auth":s}})}catch(t){return{result:!1,errMsg:"無法連接伺服器"}}return e.data},deleteFollow:async function(t){let e,s=m.getters.authToken;try{e=await d()({method:"DELETE",url:`/API/user/follow/${t}`,headers:{"x-auth":s}})}catch(t){return{result:!1,errMsg:"無法連接伺服器"}}return e.data},updateUser:async function(t,e){let s;try{s=await d()({method:"PUT",url:`/api/users/${t}`,data:e})}catch(t){return{success:!1,messages:"User update failed"}}return s.data}},E={name:"FollowBtn",props:["userId","following"],components:{ErrorMessageBar:k},data:function(){return{isFollowing:this.following,followingBtnTxt:"追蹤中",errorMessage:""}},computed:{isLoginedUser:function(){return this.userId===this.$store.getters.userAccount}},watch:{following:function(){this.isFollowing=this.following}},methods:{followClickEventHandler:function(t){var e=this;return w()(C.a.mark(function t(){var s;return C.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(e.$store.getters.isLogin){t.next=4;break}e.$router.push("/login"),t.next=6;break;case 4:if(!e.isLoginedUser){t.next=6;break}return t.abrupt("return");case 6:return t.next=8,b.follow(e.userId);case 8:if((s=t.sent).result){t.next=12;break}return e.errorMessage=s.errMsg,t.abrupt("return");case 12:e.isFollowing=!0,e.followingBtnTxt="追蹤中";case 14:case"end":return t.stop()}},t,e)}))()},backFollowClickEventHandler:function(t){var e=this;return w()(C.a.mark(function t(){var s;return C.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(e.$store.getters.isLogin){t.next=4;break}e.$router.push("/login"),t.next=6;break;case 4:if(!e.isLoginedUser){t.next=6;break}return t.abrupt("return");case 6:return t.next=8,b.deleteFollow(e.userId);case 8:if((s=t.sent).result){t.next=12;break}return e.errorMessage=s.errMsg,t.abrupt("return");case 12:e.isFollowing=!1,e.followingBtnTxt="追蹤";case 14:case"end":return t.stop()}},t,e)}))()},backFollowMouseEnterEventHandler:function(t){this.isFollowing&&(this.followingBtnTxt="取消追蹤")},backFollowMouseLeaveEventHandler:function(t){this.isFollowing&&(this.followingBtnTxt="追蹤中")}}},I={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return t.isLoginedUser?t._e():s("div",{staticClass:"FollowBtnContainer"},[t.errorMessage?s("ErrorMessageBar",{attrs:{text:t.errorMessage}}):t._e(),t._v(" "),t.isFollowing?t._e():s("button",{staticClass:"FollowBtn",on:{click:t.followClickEventHandler}},[t._v("追蹤")]),t._v(" "),t.isFollowing?s("button",{staticClass:"BackFollowBtn",on:{mouseenter:t.backFollowMouseEnterEventHandler,mouseleave:t.backFollowMouseLeaveEventHandler,click:t.backFollowClickEventHandler}},[t._v(t._s(t.followingBtnTxt))]):t._e()],1)},staticRenderFns:[]};var y=s("VU/8")(E,I,!1,function(t){s("WJ2X")},null,null).exports;var j={GetPersonBasicInfo:async function(t){let e,s=m.getters.authToken;try{e=await d()({methods:"get",url:`/API/person/${t}`,headers:{"x-auth":s}})}catch(t){return{result:!1,errMsg:"無法連接伺服器"}}return e.data},GetPersonFollowingInfo:async function(t){let e,s=m.getters.authToken;try{e=await d()({methods:"get",url:`/API/person/${t}/following`,headers:{"x-auth":s}})}catch(t){return{result:!1,errMsg:"無法連接伺服器"}}return e.data},GetPersonFollowerInfo:async function(t){let e,s=m.getters.authToken;try{e=await d()({methods:"get",url:`/API/person/${t}/follower`,headers:{"x-auth":s}})}catch(t){return{result:!1,errMsg:"無法連接伺服器"}}return e.data},GetPersonPosts:async function(t){let e,s=m.getters.authToken;try{e=await d()({method:"GET",url:`/API/person/${t}/posts`,headers:{"x-auth":s}})}catch(t){return{result:!1,errMsg:"無法連接伺服器"}}return e.data}},T={name:"PersonalHome",components:{FollowBtn:y,ErrorMessageBar:k},data:function(){return{personAccount:null,person:null,needPersonalWallFix:!1,isFollowing:!1,errorMessage:""}},computed:{isLoginedUser:function(){return this.personAccount===this.$store.getters.userAccount},postsCount:function(){return this.person?this.person.posts.length:0},followingCount:function(){return this.person?this.person.following.length:0},followerCount:function(){return this.person?this.person.follower.length:0},personName:function(){return this.person?this.person.name:""},personID:function(){return this.person?this.person._id:null},personImg:function(){return this.person?this.person.profileImg:""},personBkgImg:function(){return this.person?this.person.bkgWallImg:""}},created:function(){this.initUserID(),window.addEventListener("scroll",this.windowScrollEventHandler)},watch:{"$route.params.PersonAccount":"initUserID"},methods:{initUserID:function(){var t=this;return w()(C.a.mark(function e(){var s;return C.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.personAccount=t.$route.params.PersonAccount,e.next=3,j.GetPersonBasicInfo(t.personAccount);case 3:if((s=e.sent).result){e.next=8;break}return t.errorMessage=s.errMsg,document.title="Twitter Clone",e.abrupt("return");case 8:t.person=s.person,t.isFollowing=s.isFollowing,document.title=t.person.name+" (@"+t.person.account+")";case 11:case"end":return e.stop()}},e,t)}))()},windowScrollEventHandler:function(t){this.needPersonalWallFix=$(window).scrollTop()>300}}},L={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{attrs:{id:"PersonalHome",fix:t.needPersonalWallFix}},[t.errorMessage?s("ErrorMessageBar",{attrs:{text:t.errorMessage}}):t._e(),t._v(" "),s("div",{staticClass:"PersonalWall"},[s("div",{staticClass:"WallImgContainer"},[s("div",{staticClass:"BkgImgContainer",style:"background-image: url("+t.personBkgImg+")"}),t._v(" "),s("div",{staticClass:"ProfileImgContainer"},[s("div",{staticClass:"ProfileImg"},[s("a",{staticClass:"ProfileImgLink",attrs:{href:"#"}},[s("img",{attrs:{src:t.personImg,alt:""}})])])])]),t._v(" "),s("div",{staticClass:"ProfileInfoContainer"},[s("div",{staticClass:"ProfileInfoWrapper"},[s("div",{staticClass:"CardContainer"},[s("div",{staticClass:"ImgWrapper"},[s("a",{attrs:{href:"#"}},[s("img",{attrs:{src:t.personImg,alt:""}})])]),t._v(" "),s("div",{staticClass:"NameInfo"},[s("span",[t._v(t._s(t.personName))])])]),t._v(" "),s("div",{staticClass:"TabContainer"},[s("router-link",{staticClass:"TabItem",attrs:{to:{name:"PersonPosts",params:{PersonAccount:t.personAccount}},"exact-active-class":"active"}},[s("div",{staticClass:"TabTxt"},[s("div",{staticClass:"TabTitle"},[t._v("推文")]),t._v(" "),s("div",{staticClass:"Count"},[t._v(t._s(t.postsCount))])])]),t._v(" "),s("router-link",{staticClass:"TabItem",attrs:{to:{name:"PersonFollowing",params:{PersonAccount:t.personAccount}},"exact-active-class":"active"}},[s("div",{staticClass:"TabTxt"},[s("div",{staticClass:"TabTitle"},[t._v("正在跟隨")]),t._v(" "),s("div",{staticClass:"Count"},[t._v(t._s(t.followingCount))])])]),t._v(" "),s("router-link",{staticClass:"TabItem",attrs:{to:{name:"PersonFollower",params:{PersonAccount:t.personAccount}},"exact-active-class":"active"}},[s("div",{staticClass:"TabTxt"},[s("div",{staticClass:"TabTitle"},[t._v("跟隨者")]),t._v(" "),s("div",{staticClass:"Count"},[t._v(t._s(t.followerCount))])])])],1),t._v(" "),s("FollowBtn",{attrs:{following:t.isFollowing,userId:t.personAccount}})],1)])]),t._v(" "),s("div",{staticClass:"WallContent"},[s("div",{staticClass:"ContentContainer"},[s("div",{staticClass:"LeftSideContent"}),t._v(" "),s("div",{staticClass:"RightSideContent"},[s("router-view")],1)])])],1)},staticRenderFns:[]};var B=s("VU/8")(T,L,!1,function(t){s("nwf7")},"data-v-2fcea0b8",null).exports;var A={getBasicInfo:async function(){let t;try{return(t=await d()({method:"GET",url:"api/user/info"})).data}catch(t){return{result:!1,errMsg:"Failed api/user/info"}}},getPosts:async function(){let t;try{return(t=await d()({method:"GET",url:"/api/user/posts"})).data}catch(t){return{success:!1,errMsg:"/api/user/posts falied"}}}};var F={SendPost:async function(t){let e;try{e=await d()({method:"POST",url:"/api/post/",data:t})}catch(t){return{success:!1,errMsg:"/api/post error"}}return e.data},ToggleLike:async function(t){let e;try{e=await d()({method:"GET",url:`/API/post/${t}/like`,headers:{"x-auth":m.getters.authToken}})}catch(t){return{success:!1,errMsg:"get likes error"}}return e.data},GetDetailPostInfo:async function(t){let e;try{e=await d()({method:"GET",url:`/api/post/${t}`})}catch(t){return{success:!1,errMsg:"/api/post/:postId"}}return e.data},DeletePost:async function(t){let e;try{e=await d()({method:"DELETE",url:`/api/post/${t}`})}catch(t){return{success:!1,errMsg:"/api/post delete error"}}return e.data}},M={name:"PostSender",components:{ErrorMessageBar:k},data:function(){return{user:this.$store.state.Auth.user,isLogin:this.$store.getters.isLogin,isEditerFocused:!1,contentEl:null,inputContent:"",errorMessage:""}},methods:{editerFocusEventHandler:function(t){this.isEditerFocused=!0,this.contentEl=t.target,t.target.innerText.trim()===t.target.getAttribute("default-txt")&&(t.target.innerText="")},editerBlurEventHandler:function(t){this.isEditerFocused=!1,t.target.innerText.trim()||(t.target.innerText=t.target.getAttribute("default-txt"))},editerInputEventHandler:function(t){this.inputContent=t.target.innerText.trim()},sendPostBtnClickEventHandler:function(t){var e=this;return w()(C.a.mark(function t(){var s,n;return C.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return s=new RegExp("\n","g"),t.next=3,F.SendPost({content:e.inputContent.replace(s,"<br>")});case 3:if((n=t.sent).success&&n.post){t.next=7;break}return e.errorMessage=n.errMsg,t.abrupt("return");case 7:e.inputContent="",e.contentEl.innerText="",e.$emit("newPost",n.post);case 10:case"end":return t.stop()}},t,e)}))()}}},H={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return t.isLogin?s("div",{staticClass:"PostSenderContainer"},[t.errorMessage?s("ErrorMessageBar",{attrs:{text:t.errorMessage,displayTime:"5000"},on:{close:function(e){t.errorMessage=""}}}):t._e(),t._v(" "),s("img",{staticClass:"UserImg",attrs:{src:t.user.profileImg}}),t._v(" "),s("div",{staticClass:"EditerContainer"},[s("div",{staticClass:"Editer",attrs:{"default-txt":"",contenteditable:""},on:{focus:t.editerFocusEventHandler,blur:t.editerBlurEventHandler,input:t.editerInputEventHandler}}),t._v(" "),t.isEditerFocused?s("button",{staticClass:"btn PostBtn",attrs:{type:"button",disabled:!t.inputContent.length},on:{mousedown:t.sendPostBtnClickEventHandler}},[t._v("publish")]):t._e()])],1):t._e()},staticRenderFns:[]};var U=s("VU/8")(M,H,!1,function(t){s("2Jc9")},"data-v-772ee735",null).exports;var R={SendCommentToPost:async function(t,e){let s,n=m.getters.authToken;try{s=await d()({method:"POST",url:`/API/comment/post/${t}`,data:e,headers:{"x-auth":n}})}catch(t){return{result:!1,errMsg:"無法連接伺服器"}}return s.data}},S={name:"PostCommentBox",props:["postId"],components:{ErrorMessageBar:k},data:function(){return{inputContent:"",errorMessage:""}},methods:{closeBtnClickEventHandler:function(t){this.$emit("Close")},editerInputEventHandler:function(t){this.inputContent=t.target.innerText.trim()},replyBtnClickEventHandler:function(t){var e=this;return w()(C.a.mark(function t(){var s;return C.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,R.SendCommentToPost(e.postId,{content:e.inputContent});case 2:if((s=t.sent).result){t.next=6;break}return e.errorMessage="糟糕，發生一些錯誤 ",t.abrupt("return");case 6:e.$emit("ReplySuccess",s.comments),e.$emit("Close");case 8:case"end":return t.stop()}},t,e)}))()}}},N={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"PostCommentSenderContainer",on:{click:function(t){t.stopPropagation()}}},[t.errorMessage?s("ErrorMessageBar",{attrs:{text:t.errorMessage,displayTime:5e3},on:{close:function(e){t.errorMessage=""}}}):t._e(),t._v(" "),s("div",{staticClass:"CommentSenderBox"},[s("div",{staticClass:"BoxHeader"},[s("div",{staticClass:"CloseBtn",on:{click:function(e){return e.stopPropagation(),t.closeBtnClickEventHandler(e)}}},[s("span",[t._v("x")])]),t._v(" "),s("div",{staticClass:"BoxTitle"},[s("span",[t._v("\n          回覆給 "),t._t("Title")],2)])]),t._v(" "),s("div",{staticClass:"BoxContent"},[s("div",{staticClass:"LeftSide"},[s("div",{staticClass:"ProfileImg"},[t._t("ProfileImg")],2)]),t._v(" "),s("div",{staticClass:"RightSide"},[s("div",{staticClass:"Info"},[s("div",{staticClass:"Name"},[t._t("Name")],2),t._v(" "),s("div",{staticClass:"UserId"},[t._v("\n            @"),s("span",{staticClass:"id"},[t._t("Account")],2)]),t._v(" "),s("div",{staticClass:"Date"},[t._t("Date")],2)]),t._v(" "),s("div",{staticClass:"Content"},[t._t("PostContent")],2)])]),t._v(" "),s("div",{staticClass:"BoxReplyContainer"},[s("div",{staticClass:"EditerContainer"},[s("div",{staticClass:"Editer",attrs:{"default-txt":"推你的回覆",contenteditable:""},on:{input:t.editerInputEventHandler}}),t._v(" "),s("button",{staticClass:"btn ReplyBtn",attrs:{type:"button",disabled:!t.inputContent.length},on:{mousedown:t.replyBtnClickEventHandler}},[t._v("回覆")])])])])],1)},staticRenderFns:[]};var D={name:"PostItem",props:["post","detailPostRouteName"],components:{PostCommentBoxComponent:s("VU/8")(S,N,!1,function(t){s("fjxD")},"data-v-f2b3f9fa",null).exports},data:function(){return{likes:[],comments:[],showReplyBox:!1}},computed:{postRouteName:function(){return this.detailPostRouteName?this.detailPostRouteName:"PersonDetailPostInfo"},RegPostDate:function(){return function(t){return l()(t).format("YYYY-MM-DD")}},likesCount:function(){return this.likes.length},isLiked:function(){return this.likes.includes(this.$store.getters.userID)},commentsCount:function(){return this.comments.length}},created:function(){this.likes=[],this.comments=[]},watch:{post:function(){this.likes=this.post.likes,this.comments=this.post.comments}},methods:{toggleLike:function(t){var e=this;return w()(C.a.mark(function s(){var n;return C.a.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,F.ToggleLike(t);case 2:(n=s.sent).result&&(e.likes=n.likes);case 4:case"end":return s.stop()}},s,e)}))()},deletePost:function(t){var e=this;return w()(C.a.mark(function s(){return C.a.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,F.DeletePost(t);case 2:s.sent.success&&(e.$emit("deletePost",t),console.log("delete"));case 4:case"end":return s.stop()}},s,e)}))()},openReplyBox:function(){if(!this.$store.getters.isLogin)return this.$router.push({name:"login"});this.showReplyBox=!0},replySuccessEventHandler:function(t){this.comments=t}}},z={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"Post"},[s("div",{staticClass:"LeftSide"},[s("div",{staticClass:"ProfileImg"},[s("img",{attrs:{src:t.post.author.profileImg,alt:""}})])]),t._v(" "),s("div",{staticClass:"RightSide"},[s("div",{staticClass:"Info"},[s("div",{staticClass:"Name"},[t._v(t._s(t.post.author.name))]),t._v(" "),s("div",{staticClass:"UserId"},[t._v("\n        @"),s("span",{staticClass:"id"},[t._v(t._s(t.post.author.account))])]),t._v(" "),s("div",{staticClass:"Date"},[t._v(t._s(t.RegPostDate(t.post.created)))])]),t._v(" "),s("div",{staticClass:"Content",domProps:{innerHTML:t._s(t.post.content)}}),t._v(" "),s("div",{staticClass:"OperationBtns"},[s("div",{staticClass:"ReplyBtn Btn"},[s("span",{staticClass:"BtnWrapper",on:{click:function(e){return e.stopPropagation(),t.openReplyBox(e)}}},[s("i",{staticClass:"far fa-comment"}),t._v(" "),s("span",{staticClass:"Count"},[t._v(t._s(t.commentsCount))])])]),t._v(" "),s("div",{staticClass:"LikeBtn Btn",attrs:{isLiked:t.isLiked}},[s("span",{staticClass:"BtnWrapper",on:{click:function(e){return e.stopPropagation(),t.toggleLike(t.post.id)}}},[t.isLiked?s("i",{staticClass:"fas fa-heart"}):t._e(),t._v(" "),t.isLiked?t._e():s("i",{staticClass:"far fa-heart"}),t._v(" "),s("span",{staticClass:"Count"},[t._v(t._s(t.likesCount))])])]),t._v(" "),s("div",{staticClass:"DeleteBtn Btn"},[s("span",{staticClass:"BtnWrapper",on:{click:function(e){return e.stopPropagation(),t.deletePost(t.post.id)}}},[s("i",{staticClass:"far fa-trash-alt"})])])])]),t._v(" "),t.showReplyBox?s("PostCommentBoxComponent",{attrs:{postId:t.post.id},on:{Close:function(e){t.showReplyBox=!1},ReplySuccess:t.replySuccessEventHandler}},[s("template",{slot:"Title"},[t._v(t._s(t.post.author.name))]),t._v(" "),s("template",{slot:"ProfileImg"},[s("img",{attrs:{src:t.post.author.profileImg,alt:""}})]),t._v(" "),s("template",{slot:"Name"},[t._v(t._s(t.post.author.name))]),t._v(" "),s("template",{slot:"Account"},[t._v(t._s(t.post.author.account))]),t._v(" "),s("template",{slot:"Date"},[t._v(t._s(t.RegPostDate(t.post.created)))]),t._v(" "),s("template",{slot:"PostContent"},[s("div",{domProps:{innerHTML:t._s(t.post.content)}})])],2):t._e()],1)},staticRenderFns:[]};var W={name:"PostBox",components:{PostItemComponent:s("VU/8")(D,z,!1,function(t){s("Kac5")},"data-v-e138a4f4",null).exports},props:["posts","detailPostRouteName"],methods:{deletePost:function(t){var e=this;return w()(C.a.mark(function s(){var n;return C.a.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:n=e.posts.map(function(t){return t.id}).indexOf(t),console.log("delete post "+n+" "+t),e.$emit("deletePost",t);case 3:case"end":return s.stop()}},s,e)}))()}}},O={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"PostsBox"},[s("div",{staticClass:"PostsContainer"},[t._l(t.posts,function(e){return s("PostItemComponent",{key:e.id,attrs:{post:e,detailPostRouteName:t.detailPostRouteName},on:{deletePost:t.deletePost}})}),t._v(" "),t.posts.length?t._e():s("div",{staticClass:"NonPost"},[s("div",{staticClass:"txt"},[t._v("None post")])])],2)])},staticRenderFns:[]};var V=s("VU/8")(W,O,!1,function(t){s("uPGP")},"data-v-47eeeebb",null).exports,q={render:function(){this.$createElement;this._self._c;return this._m(0)},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"LoadingAnimationContainer"},[e("div",{staticClass:"spinner"},[e("div",{staticClass:"dot1"}),this._v(" "),e("div",{staticClass:"dot2"})])])}]};var G=s("VU/8")({name:"LoadingAnimation"},q,!1,function(t){s("xHZh")},"data-v-71605208",null).exports,X={name:"UserHome",components:{PostCreaterComponent:U,PostsBoxComponent:V,LoadingAnimationComponent:G,ErrorMessageBar:k},data:function(){return{user:null,posts:[],userLoaded:!1,postLoaded:!1,errorMessage:""}},computed:{userName:function(){return this.user?this.user.username:""},userAccount:function(){return this.user?this.user.username:""},userImg:function(){return this.user?this.user.profileImg:""},userWallImg:function(){return"/static/img/default-user-bkg-img.jpg"},userPostsCount:function(){return this.user?this.user.posts.length:0},userFollowingCount:function(){return this.user?this.user.following.length:0}},mounted:function(){this.getUserInfo(),this.getPosts()},methods:{getUserInfo:function(){var t=w()(C.a.mark(function t(){var e;return C.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return this.userLoaded=!1,this.user=null,t.next=4,A.getBasicInfo();case 4:if(e=t.sent,this.userLoaded=!0,e.success){t.next=8;break}return t.abrupt("return");case 8:this.user=e.user,document.title=this.user.name+" (@"+this.user.account+")";case 10:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}(),getPosts:function(){var t=w()(C.a.mark(function t(){var e;return C.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return this.postLoaded=!1,this.posts=[],t.next=4,A.getPosts();case 4:if(e=t.sent,this.postLoaded=!0,e.success){t.next=9;break}return this.errorMessage=e.errMsg,t.abrupt("return");case 9:this.posts=e.posts;case 10:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}(),newPostEventHandler:function(t){this.posts.unshift(t)},deletePostEventHandler:function(t){var e=this.posts.map(function(t){return t.id}).indexOf(t);this.posts.splice(e,1)}}},Y={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"UserHomeContainer"},[t.errorMessage?s("ErrorMessageBar",{attrs:{text:t.errorMessage}}):t._e(),t._v(" "),s("div",{staticClass:"UserHomeWrapper"},[s("div",{staticClass:"LeftSideContainer"},[t.user?s("div",{staticClass:"ProfileCardContainer"},[s("router-link",{staticClass:"ProfileWallImg",style:"background-image: url("+t.userWallImg+")",attrs:{tag:"div",to:{name:"PersonPosts",params:{PersonAccount:t.userAccount}}}}),t._v(" "),s("div",{staticClass:"ProfileContentContainer"},[s("router-link",{staticClass:"ProfileUserImg",attrs:{tag:"img",to:{name:"PersonPosts",params:{PersonAccount:t.userAccount}},src:t.userImg}}),t._v(" "),s("div",{staticClass:"ProfileName"},[s("router-link",{attrs:{tag:"span",to:{name:"PersonPosts",params:{PersonAccount:t.userAccount}}}},[t._v(t._s(t.userName))])],1),t._v(" "),s("div",{staticClass:"ProfileAccount"},[s("router-link",{attrs:{tag:"span",to:{name:"PersonPosts",params:{PersonAccount:t.userAccount}}}},[t._v("@"+t._s(t.userAccount))])],1),t._v(" "),s("div",{staticClass:"ProfileInfo"},[s("div",{staticClass:"ProfilePosts"},[t._m(0),t._v(" "),s("div",{staticClass:"Count"},[s("span",[t._v(t._s(t.userPostsCount))])])]),t._v(" "),s("div",{staticClass:"ProfileFollowing"},[t._m(1),t._v(" "),s("div",{staticClass:"Count"},[s("span",[t._v(t._s(t.userFollowingCount))])])])])],1)],1):t._e()]),t._v(" "),s("div",{staticClass:"RightSideContainer"},[s("LoadingAnimationComponent",{class:{loadingAnimation:!0,loaded:t.postLoaded}}),t._v(" "),s("PostCreaterComponent",{on:{newPost:t.newPostEventHandler}}),t._v(" "),t.postLoaded?s("PostsBoxComponent",{attrs:{posts:t.posts,detailPostRouteName:"UserDetailPostInfo"},on:{deletePost:t.deletePostEventHandler}}):t._e(),t._v(" "),s("router-view")],1)])],1)},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"Title"},[e("span",[this._v("Total Posts")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"Title"},[e("span",[this._v("Following")])])}]};var Q=s("VU/8")(X,Y,!1,function(t){s("E2CX")},"data-v-7e1293ca",null).exports,J={name:"EditProfile",data:function(){return{name:null,username:null,bio:null,user:{},password:null,errHint:""}},created:function(){this.getUserData()},methods:{saveUser:function(){var t=this;return w()(C.a.mark(function e(){var s,n;return C.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return s={},t.name&&(s.name=t.name),t.password&&(s.password=t.password),t.bio&&(s.bio=t.bio),e.next=6,b.updateUser(t.user.id,s);case 6:n=e.sent,t.errHint=n.message;case 8:case"end":return e.stop()}},e,t)}))()},getUserData:function(){var t=this;return w()(C.a.mark(function e(){return C.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t.user=t.$store.state.Auth.user,t.name=t.user.name,t.bio=t.user.bio;case 3:case"end":return e.stop()}},e,t)}))()}}},Z={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{attrs:{id:"EditProfile"}},[s("div",{staticClass:"RegistFormContainer"},[s("div",{staticClass:"Wrapper"},[t._m(0),t._v(" "),t.errHint?s("div",{staticClass:"ErrHint alert alert-danger"},[t._v("\n        "+t._s(t.errHint)+"\n      ")]):t._e(),t._v(" "),s("div",{staticClass:"RegistInput"},[s("div",{staticClass:"name input"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.name,expression:"name"}],attrs:{type:"text",placeholder:"Name"},domProps:{value:t.name},on:{input:function(e){e.target.composing||(t.name=e.target.value)}}})]),t._v(" "),s("div",{staticClass:"password input"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.password,expression:"password"}],attrs:{type:"password",placeholder:"password"},domProps:{value:t.password},on:{input:function(e){e.target.composing||(t.password=e.target.value)}}})]),t._v(" "),s("div",{staticClass:"bio input"},[s("textarea",{directives:[{name:"model",rawName:"v-model",value:t.bio,expression:"bio"}],attrs:{type:"textarea",placeholder:"About you"},domProps:{value:t.bio},on:{input:function(e){e.target.composing||(t.bio=e.target.value)}}})])]),t._v(" "),s("div",{staticClass:"Submit"},[s("button",{staticClass:"btn submit",attrs:{type:"button"},on:{click:t.saveUser}},[t._v("Done")])])])]),t._v(" "),s("div",{staticClass:"LoginHint"},[s("div",{staticClass:"Wrapper"},[s("div",{staticClass:"hint"},[s("span",[t._v("Already registered ?")]),t._v(" "),s("router-link",{attrs:{to:"/login"}},[t._v("sign in »")])],1)])])])},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"RegistText"},[e("span",[this._v("Edit profile")])])}]};var K=s("VU/8")(J,Z,!1,function(t){s("96Oq")},"data-v-0cbb2dfc",null).exports,tt={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"UserSearchBarContainer"},[s("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.searchText,expression:"searchText",modifiers:{trim:!0}}],staticClass:"SearchInput",attrs:{type:"text",placeholder:"Search"},domProps:{value:t.searchText},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.search(e)},input:function(e){e.target.composing||(t.searchText=e.target.value.trim())},blur:function(e){return t.$forceUpdate()}}}),t._v(" "),s("i",{staticClass:"fas fa-search search-btn",on:{click:function(e){return e.stopPropagation(),t.search(e)}}})])},staticRenderFns:[]};var et={name:"TopNavBar",components:{SearchBar:s("VU/8")({name:"SearchBar",data:function(){return{searchText:""}},methods:{search:function(){if(this.searchText){var t=this.searchText.toString();this.searchText="",this.$router.push({name:"Search",params:{query:t}})}}}},tt,!1,function(t){s("DN7r")},"data-v-063e3455",null).exports},data:function(){return{isLogin:this.$store.getters.isLogin,user:this.$store.state.Auth.user,showStatus:!1}},watch:{"$store.getters.isLogin":function(){this.isLogin=this.$store.getters.isLogin,this.user=this.$store.state.Auth.user},$route:function(){this.showStatus=!1}},methods:{logout:function(){this.$store.dispatch("logout"),window.location.reload()}}},st={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{attrs:{id:"TopNavBar"}},[s("div",{staticClass:"Navbar"},[s("div",{staticClass:"left-side"},[s("router-link",{staticClass:"home-btn-link",attrs:{to:"/"}},[s("div",{staticClass:"link-wrapper"},[s("span",{staticClass:"twitter-img"}),t._v(" "),s("span",[t._v("My community")])])])],1),t._v(" "),s("div",{staticClass:"right-side"},[s("SearchBar"),t._v(" "),t.isLogin?s("div",{staticClass:"UserStatusContainer"},[s("img",{staticClass:"UserImg",attrs:{src:t.user.profileImg},on:{click:function(e){e.stopPropagation(),t.showStatus=!t.showStatus}}}),t._v(" "),t.showStatus?s("div",{staticClass:"StatusContainer"},[s("router-link",{staticClass:"UserInfo",attrs:{tag:"div",to:"/"+t.user.username}},[s("div",{staticClass:"Username"},[t._v("@"+t._s(t.user.username))])]),t._v(" "),s("div",{staticClass:"divider"}),t._v(" "),s("router-link",{staticClass:"EditProfile",attrs:{tag:"div",to:"/"+t.user.username+"/edit"}},[s("div",{staticClass:"Username"},[t._v("Edit profile")])]),t._v(" "),s("div",{staticClass:"divider"}),t._v(" "),s("div",{staticClass:"Btns"},[s("div",{staticClass:"BtnItem",on:{click:function(e){return e.stopPropagation(),t.logout(e)}}},[t._v("Sign out")])])],1):t._e()]):t._e()],1)])])},staticRenderFns:[]};var nt=s("VU/8")(et,st,!1,function(t){s("4ZZk")},"data-v-02a1d67c",null).exports,rt={name:"PersonalDefault",components:{LoadingAnimationComponent:G,PostCreaterComponent:U,PostsBoxComponent:V},data:function(){return{posts:[],loaded:!1}},computed:{isLoginedUser:function(){return this.$route.params.PersonAccount===this.$store.getters.userAccount}},created:function(){this.getPersonPosts()},watch:{"$route.params.PersonAccount":"getPersonPosts"},methods:{getPersonPosts:function(){var t=this;return w()(C.a.mark(function e(){var s,n;return C.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.posts=[],t.loaded=!1,s=t.$route.params.PersonAccount,e.next=5,j.GetPersonPosts(s);case 5:if(n=e.sent,t.loaded=!0,n.result){e.next=10;break}return console.log(n),e.abrupt("return");case 10:t.posts=n.posts;case 11:case"end":return e.stop()}},e,t)}))()},newPostEventHandler:function(t){this.posts.unshift(t)}}},at={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{attrs:{id:"PersonalPost"}},[t._m(0),t._v(" "),s("LoadingAnimationComponent",{class:{loadingAnimation:!0,loaded:t.loaded}}),t._v(" "),t.isLoginedUser?s("PostCreaterComponent",{on:{newPost:t.newPostEventHandler}}):t._e(),t._v(" "),t.loaded?s("PostsBoxComponent",{attrs:{posts:t.posts,detailPostRouteName:"PersonDetailPostInfo"}}):t._e(),t._v(" "),s("router-view",{attrs:{name:"DetailPostInfoComponent"}})],1)},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"HeadContainer"},[e("div",{staticClass:"Content"},[e("div",{staticClass:"Txt"},[this._v("\n        推文\n      ")])])])}]};var ot=s("VU/8")(rt,at,!1,function(t){s("lbuX")},"data-v-7450d530",null).exports,it={name:"PeopleItem",props:["person"],components:{FollowBtn:y}},ct={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return t.person?s("div",{staticClass:"ItemContainer"},[s("div",{staticClass:"Item"},[s("div",{staticClass:"BkgWall",style:"background-image: url("+t.person.bkgWallImg+")"}),t._v(" "),s("div",{staticClass:"Content"},[s("div",{staticClass:"ProfileImg"},[s("img",{attrs:{src:t.person.profileImg,alt:""}})]),t._v(" "),s("div",{staticClass:"Btn"},[s("FollowBtn",{staticClass:"small",attrs:{userId:t.person.account,following:!!t.person.isFollowing}})],1),t._v(" "),s("div",{staticClass:"ProfileInfo"},[s("div",{staticClass:"Name"},[s("router-link",{attrs:{to:"/"+t.person.account}},[t._v("\n            "+t._s(t.person.name)+"\n          ")])],1),t._v(" "),s("div",{staticClass:"ID"},[t._v("\n          @"+t._s(t.person.account)+"\n        ")]),t._v(" "),s("div",{staticClass:"Des"})])])])]):t._e()},staticRenderFns:[]};var lt={name:"PeopleBox",props:["personList","columnCount"],components:{PersonItem:s("VU/8")(it,ct,!1,function(t){s("d0CW")},"data-v-173b9686",null).exports},computed:{itemWidth:function(){return Number(this.columnCount)?100/this.columnCount+"%":"50%"}}},ut={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"PersonListContainer"},[t.personList?s("div",{staticClass:"List"},t._l(t.personList,function(e){return s("PersonItem",{key:e._id,style:"width: "+t.itemWidth,attrs:{person:e}})}),1):t._e()])},staticRenderFns:[]};var dt=s("VU/8")(lt,ut,!1,function(t){s("s7FQ")},"data-v-5b742462",null).exports,pt={name:"PersonFollowingList",components:{PeopleBox:dt,LoadingAnimationComponent:G},data:function(){return{personList:[],loaded:!1}},created:function(){this.getPersonListInfo()},watch:{"$route.params.PersonAccount":"getPersonListInfo"},methods:{getPersonListInfo:function(){var t=this;return w()(C.a.mark(function e(){var s,n;return C.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.loaded=!1,t.personList=[],s=t.$route.params.PersonAccount,e.next=5,j.GetPersonFollowingInfo(s);case 5:if(n=e.sent,t.loaded=!0,n.result){e.next=10;break}return console.log(n.errMsg),e.abrupt("return");case 10:t.personList=n.following;case 11:case"end":return e.stop()}},e,t)}))()}}},vt={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{attrs:{id:"FollowingList"}},[t.loaded?t._e():s("LoadingAnimationComponent"),t._v(" "),s("div",{staticClass:"ListContainer"},[s("PeopleBox",{attrs:{personList:t.personList}})],1),t._v(" "),t.personList.length?t._e():s("div",{staticClass:"NonPerson"},[s("div",{staticClass:"txt"},[t._v("尚未追蹤用戶")])])],1)},staticRenderFns:[]};var mt=s("VU/8")(pt,vt,!1,function(t){s("Xzbe")},"data-v-260c6a2b",null).exports,ft={name:"PersonFollowingList",components:{PeopleBox:dt,LoadingAnimationComponent:G},data:function(){return{personList:[],loaded:!1}},created:function(){this.getPersonListInfo()},watch:{"$route.params.PersonAccount":"getPersonListInfo"},methods:{getPersonListInfo:function(){var t=this;return w()(C.a.mark(function e(){var s,n;return C.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.loaded=!1,t.personList=[],s=t.$route.params.PersonAccount,e.next=5,j.GetPersonFollowerInfo(s);case 5:if(n=e.sent,t.loaded=!0,n.result){e.next=10;break}return console.log(n.errMsg),e.abrupt("return");case 10:t.personList=n.follower;case 11:case"end":return e.stop()}},e,t)}))()}}},ht={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{attrs:{id:"FollowingList"}},[t.loaded?t._e():s("LoadingAnimationComponent"),t._v(" "),s("div",{staticClass:"ListContainer"},[s("PeopleBox",{attrs:{personList:t.personList}})],1),t._v(" "),t.personList.length?t._e():s("div",{staticClass:"NonPerson"},[s("div",{staticClass:"txt"},[t._v("尚無追蹤者")])])],1)},staticRenderFns:[]};var gt=s("VU/8")(ft,ht,!1,function(t){s("Qa4q")},"data-v-14accf96",null).exports,Ct={name:"DetailPostInfo",props:["backRoute"],components:{FollowBtnComponent:y,LoadingAnimationComponent:G,ErrorMessageBar:k},data:function(){return{personAccount:this.$route.params.PersonAccount,Post:null,id:this.$route.params.id,loaded:!1,errorMessage:"",inputContent:"",contentEl:null,isEditerFocused:!1}},computed:{routeWhenClosing:function(){return this.backRoute?this.backRoute:{name:"PersonPosts",params:{PersonAccount:this.personAccount}}},RegPostDate:function(){return l.a.updateLocale("zh-cn",{meridiem:function(t,e,s){return t<9?"早上":t<11&&e<30?"上午":t<13&&e<30?"中午":t<18?"下午":"晚上"}}),function(t){return l()(t).format("a h:m - YYYY年M月D日")}},RegCommentDate:function(){return function(t){return l()(t).format("YYYY年M月D日")}},loginedUser:function(){return this.$store.state.Auth.user||null}},created:function(){this.GetPostInfo(),$("body").css({height:"100vh","overflow-y":"hidden"})},destroyed:function(){$("body").css({height:"","overflow-y":""})},methods:{GetPostInfo:function(){var t=this;return w()(C.a.mark(function e(){var s;return C.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.Post=null,t.loaded=!1,e.next=4,F.GetDetailPostInfo(t.id);case 4:if(s=e.sent,t.loaded=!0,s.success){e.next=9;break}return t.errorMessage=s.errMsg,e.abrupt("return");case 9:t.Post=s.post;case 10:case"end":return e.stop()}},e,t)}))()},closeEvent:function(t){this.$router.replace(this.routeWhenClosing)},editerFocusEventHandler:function(t){this.contentEl=t.target,this.isEditerFocused=!0},editerBlurEventHandler:function(t){this.isEditerFocused=!1,t.target.innerText=t.target.innerText.trim()},editerInputEventHandler:function(t){this.inputContent=t.target.innerText.trim()},replyBtnClickEventHandler:function(){var t=this;return w()(C.a.mark(function e(){var s,n;return C.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return s=new RegExp("\n","g"),e.next=3,R.SendCommentToPost(t.id,{content:t.inputContent.replace(s,"<br>")});case 3:if((n=e.sent).success){e.next=7;break}return console.log(n),e.abrupt("return");case 7:t.contentEl.innerHTML="",t.Post.comments=n.comments;case 9:case"end":return e.stop()}},e,t)}))()}}},_t={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"DetailPostInfoContainer",on:{click:function(t){t.stopPropagation()}}},[s("div",{staticClass:"CloseBtn",on:{click:function(e){return e.stopPropagation(),t.closeEvent(e)}}},[t._v("╳")]),t._v(" "),t.loaded?t._e():s("LoadingAnimationComponent",{staticClass:"loadingAnimation"}),t._v(" "),t.errorMessage?s("ErrorMessageBar",{attrs:{text:t.errorMessage}}):t._e(),t._v(" "),t.Post?s("div",{staticClass:"DetailPostInfoBox"},[s("div",{staticClass:"PersonBox"},[t._m(0),t._v(" "),s("div",{staticClass:"RightSide"},[s("div",{staticClass:"Info"},[s("div",{staticClass:"Name"},[t._v("\n            "+t._s(t.Post.author.name)+"\n          ")]),t._v(" "),s("div",{staticClass:"UserId"},[t._v("\n            @"),s("span",{staticClass:"id"},[t._v(t._s(t.Post.author.id)+"\n            ")])])])]),t._v(" "),s("FollowBtnComponent",{attrs:{userId:t.Post.author.account,following:t.Post.author.isFollowing}})],1),t._v(" "),s("div",{staticClass:"PostContentBox",domProps:{innerHTML:t._s(t.Post.content)}}),t._v(" "),s("div",{staticClass:"PostDate"},[t._v("\n      "+t._s(t.RegPostDate(t.Post.createdAt))+"\n    ")]),t._v(" "),s("div",{staticClass:"Status"},[s("div",{staticClass:"CommentCount"},[s("span",[s("span",{staticClass:"count"},[t._v(t._s(t.Post.comments.length))]),t._v(" 個回覆")])]),t._v(" "),s("div",{staticClass:"LikeCount"},[s("span",[s("span",{staticClass:"count"},[t._v(t._s(t.Post.likes.length))]),t._v(" 個喜歡")])]),t._v(" "),s("div",{staticClass:"LikePersonImg"},t._l(t.Post.likes,function(e,n){return n<10?s("router-link",{key:e._id,staticClass:"LikeUserLink",attrs:{to:"/"+e.account}},[s("img",{attrs:{src:e.profileImg,title:e.name}})]):t._e()}),1)]),t._v(" "),t.loginedUser?s("div",{staticClass:"BoxReplyContainer"},[s("img",{staticClass:"UserProfileImg",attrs:{src:t.loginedUser.profileImg}}),t._v(" "),s("div",{staticClass:"EditerContainer"},[s("div",{staticClass:"Editer",attrs:{"default-txt":"推你的回覆",contenteditable:""},on:{focus:t.editerFocusEventHandler,blur:t.editerBlurEventHandler,input:t.editerInputEventHandler}}),t._v(" "),t.isEditerFocused?s("button",{staticClass:"btn ReplyBtn",attrs:{type:"button",disabled:!t.inputContent.length},on:{mousedown:t.replyBtnClickEventHandler}},[t._v("回覆")]):t._e()])]):t._e(),t._v(" "),s("div",{staticClass:"CommentsContainer"},t._l(t.Post.comments,function(e){return s("div",{key:e._id,staticClass:"CommentItem"},[s("div",{staticClass:"CommentImgWrapper"},[s("img",{staticClass:"CommentPersonImg",attrs:{src:e.user.profileImg}})]),t._v(" "),s("div",{staticClass:"CommentInfoWrapper"},[s("div",{staticClass:"CommentBasicInfo"},[s("div",{staticClass:"CommentPersonName"},[s("span",[t._v(t._s(e.user.name))])]),t._v(" "),s("div",{staticClass:"CommentPersonAccount"},[s("span",[t._v("@"+t._s(e.user.account))])]),t._v(" "),s("div",{staticClass:"CommentDate"},[s("span",[t._v(t._s(t.RegCommentDate(e.created)))])])]),t._v(" "),s("div",{staticClass:"CommentContent",domProps:{innerHTML:t._s(e.content)}})])])}),0)]):t._e()],1)},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"LeftSide"},[e("div",{staticClass:"ProfileImg"},[e("img",{attrs:{src:"Post.author.profileImg",alt:""}})])])}]};var wt=s("VU/8")(Ct,_t,!1,function(t){s("oJup")},"data-v-db15c36c",null).exports,Pt=[{path:"/",name:"Home",component:h,beforeEnter(t,e,s){if(m.getters.isLogin)return s({name:"UserHome"});document.title="My community",s()}},{path:"/:PersonAccount",redirect:{name:"PersonPosts"},components:{TopNavBar:nt,default:B},children:[{path:".",name:"PersonPosts",component:ot,children:[{path:"post/:PostId",name:"PersonDetailPostInfo",components:{DetailPostInfoComponent:wt}}]},{path:"following",name:"PersonFollowing",component:mt},{path:"follower",name:"PersonFollower",component:gt}]},{path:"/",name:"UserHome",components:{TopNavBar:nt,default:Q},children:[{path:":PersonAccount/post/:id",name:"UserDetailPostInfo",props:{backRoute:"/"},component:wt}],beforeEnter:(t,e,s)=>m.getters.isLogin?s():s({name:"Home"})},{path:"/:PersonAccount/edit",name:"EditProfile",components:{TopNavBar:nt,default:K},beforeEnter:(t,e,s)=>m.getters.isLogin?s():s({name:"Home"})}];var xt={searchUsers:async function(t){let e,s=m.getters.authToken;try{return(e=await d()({method:"GET",url:`/API/search/person/${t}`,headers:{"x-auth":s}})).data}catch(t){return{result:!1,errMsg:"無法連接伺服器"}}}},kt={name:"SearchView",props:["query"],components:{PeopleBox:dt,LoadingAnimationComponent:G,ErrorMessageBar:k},data:function(){return{personList:[],loaded:!1,errorMessage:""}},created:function(){this.searchUsers()},watch:{query:"searchUsers"},methods:{searchUsers:function(){var t=this;return w()(C.a.mark(function e(){var s;return C.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.loaded=!1,t.personList=[],e.next=4,xt.searchUsers(t.query.trim());case 4:if(s=e.sent,t.loaded=!0,s.result){e.next=10;break}return t.errorMessage="糟糕，發生了一些錯誤！",console.log(s),e.abrupt("return");case 10:t.personList=s.users;case 11:case"end":return e.stop()}},e,t)}))()}}},bt={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"SearchViewContainer"},[t.errorMessage?s("ErrorMessageBar",{attrs:{text:t.errorMessage}}):t._e(),t._v(" "),s("div",{staticClass:"QueryTextContainer"},[s("div",{staticClass:"QueryTextWrapper"},[t._v(t._s(t.query))])]),t._v(" "),t._m(0),t._v(" "),s("div",{staticClass:"SearchResultContainer"},[s("LoadingAnimationComponent",{class:{loadingAnimation:!0,loaded:t.loaded}}),t._v(" "),s("div",{staticClass:"SearchResultWrapper"},[s("PeopleBox",{attrs:{personList:t.personList,columnCount:"3"}})],1),t._v(" "),t.loaded&&!t.personList.length?s("div",{staticClass:"NoData"},[t._v("\n      無搜尋結果\n    ")]):t._e()],1)],1)},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"QueryTypesContainer"},[e("div",{staticClass:"QueryTypesWrapper"},[e("div",{staticClass:"TypesList"},[e("div",{staticClass:"TypesItem active"},[this._v("\n          人們\n        ")])])])])}]};var Et=[{path:"/search/:query",name:"Search",props:{TopNavBar:!1,default:!0},components:{TopNavBar:nt,default:s("VU/8")(kt,bt,!1,function(t){s("F7mj")},"data-v-de767f24",null).exports},meta:{title:"Search"}}],It={name:"LoginPage",data:function(){return{username:null,password:null,errHint:null}},methods:{loginEventHandeler:function(){var t=this;return w()(C.a.mark(function e(){var s;return C.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.$store.dispatch("login",{username:t.username,password:t.password});case 2:if((s=e.sent).success){e.next=7;break}return console.log(s),t.errHint=s.errMsg,e.abrupt("return");case 7:t.$router.push("/");case 8:case"end":return e.stop()}},e,t)}))()}}},yt={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{attrs:{id:"LoginPage"}},[s("div",{staticClass:"LoginFormContainer"},[s("div",{staticClass:"Wrapper"},[t._m(0),t._v(" "),t.errHint?s("div",{staticClass:"ErrHint alert alert-danger"},[t._v("\n        "+t._s(t.errHint)+"\n      ")]):t._e(),t._v(" "),s("div",{staticClass:"LoginInput"},[s("div",{staticClass:"username"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.username,expression:"username"}],attrs:{type:"text",placeholder:"username"},domProps:{value:t.username},on:{input:function(e){e.target.composing||(t.username=e.target.value)}}})]),t._v(" "),s("div",{staticClass:"password"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.password,expression:"password"}],attrs:{type:"password",placeholder:"password"},domProps:{value:t.password},on:{input:function(e){e.target.composing||(t.password=e.target.value)}}})])]),t._v(" "),s("div",{staticClass:"Submit"},[s("button",{staticClass:"btn submit",attrs:{type:"button"},on:{click:t.loginEventHandeler}},[t._v("Sign in")])])])]),t._v(" "),s("div",{staticClass:"RegistHint"},[s("div",{staticClass:"Wrapper"},[s("div",{staticClass:"hint"},[s("span",[t._v(" No account? ")]),t._v(" "),s("router-link",{attrs:{to:"/regist"}},[t._v("Sign up »")])],1)])])])},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"LoginText"},[e("span",[this._v("Sign in")])])}]};var jt=[{path:"/login",name:"login",components:{TopNavBar:nt,default:s("VU/8")(It,yt,!1,function(t){s("ON3g")},"data-v-c49232d4",null).exports},meta:{requireNotLogin:!0,title:"Login"}}],Tt={name:"RegistPage",data:function(){return{name:null,username:null,password:null,password2:null,errHint:""}},methods:{registEventHandler:function(){var t=this;return w()(C.a.mark(function e(){var s;return C.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.$store.dispatch("regist",{name:t.name,username:t.username,password:t.password,password2:t.password2});case 2:if(!1!==(s=e.sent).success){e.next=6;break}return t.errHint=s.message,e.abrupt("return");case 6:t.$router.push("/login");case 7:case"end":return e.stop()}},e,t)}))()}}},Lt={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{attrs:{id:"RegistPage"}},[s("div",{staticClass:"RegistFormContainer"},[s("div",{staticClass:"Wrapper"},[t._m(0),t._v(" "),t.errHint?s("div",{staticClass:"ErrHint alert alert-danger"},[t._v("\n        "+t._s(t.errHint)+"\n      ")]):t._e(),t._v(" "),s("div",{staticClass:"RegistInput"},[s("div",{staticClass:"username"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.username,expression:"username"}],attrs:{type:"text",placeholder:"Username"},domProps:{value:t.username},on:{input:function(e){e.target.composing||(t.username=e.target.value)}}})]),t._v(" "),s("div",{staticClass:"name"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.name,expression:"name"}],attrs:{type:"text",placeholder:"Name"},domProps:{value:t.name},on:{input:function(e){e.target.composing||(t.name=e.target.value)}}})]),t._v(" "),s("div",{staticClass:"password"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.password,expression:"password"}],attrs:{type:"password",placeholder:"password"},domProps:{value:t.password},on:{input:function(e){e.target.composing||(t.password=e.target.value)}}})]),t._v(" "),s("div",{staticClass:"password-confirm"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.password2,expression:"password2"}],attrs:{type:"password",placeholder:"password confirm"},domProps:{value:t.password2},on:{input:function(e){e.target.composing||(t.password2=e.target.value)}}})])]),t._v(" "),s("div",{staticClass:"Submit"},[s("button",{staticClass:"btn submit",attrs:{type:"button"},on:{click:t.registEventHandler}},[t._v("Done")])])])]),t._v(" "),s("div",{staticClass:"LoginHint"},[s("div",{staticClass:"Wrapper"},[s("div",{staticClass:"hint"},[s("span",[t._v("Already registered ?")]),t._v(" "),s("router-link",{attrs:{to:"/login"}},[t._v("sign in »")])],1)])])])},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"RegistText"},[e("span",[this._v("Create your username")])])}]};var Bt=[{path:"/regist",name:"regist",components:{TopNavBar:nt,default:s("VU/8")(Tt,Lt,!1,function(t){s("etxS")},"data-v-6e281c4e",null).exports},meta:{requireNotLogin:!0,title:"Sign up"}}];n.a.use(o.a);const At=new o.a({mode:"history",routes:[...jt,...Bt,...Et,...Pt]});At.beforeEach(async(t,e,s)=>{if((!m.getters.isAuthChecked||m.getters.isLogin&&!m.getters.isInMaxDurationTime())&&(await m.dispatch("checkAuth"),console.log("Auth Updated")),t.meta.requireNotLogin&&m.getters.isLogin)return s("/");t.meta.title&&(document.title=t.meta.title),s()});var Ft=At;n.a.config.productionTip=!1,new n.a({router:Ft,store:m,components:{App:a},render:t=>t(a)}).$mount("#app")},ON3g:function(t,e){},Oj8z:function(t,e){},Qa4q:function(t,e){},SuMS:function(t,e){},WJ2X:function(t,e){},Xzbe:function(t,e){},d0CW:function(t,e){},etxS:function(t,e){},fjxD:function(t,e){},lbuX:function(t,e){},nwf7:function(t,e){},oJup:function(t,e){},s7FQ:function(t,e){},uPGP:function(t,e){},uslO:function(t,e,s){var n={"./af":"3CJN","./af.js":"3CJN","./ar":"3MVc","./ar-dz":"tkWw","./ar-dz.js":"tkWw","./ar-kw":"j8cJ","./ar-kw.js":"j8cJ","./ar-ly":"wPpW","./ar-ly.js":"wPpW","./ar-ma":"dURR","./ar-ma.js":"dURR","./ar-sa":"7OnE","./ar-sa.js":"7OnE","./ar-tn":"BEem","./ar-tn.js":"BEem","./ar.js":"3MVc","./az":"eHwN","./az.js":"eHwN","./be":"3hfc","./be.js":"3hfc","./bg":"lOED","./bg.js":"lOED","./bm":"hng5","./bm.js":"hng5","./bn":"aM0x","./bn-bd":"1C9R","./bn-bd.js":"1C9R","./bn.js":"aM0x","./bo":"w2Hs","./bo.js":"w2Hs","./br":"OSsP","./br.js":"OSsP","./bs":"aqvp","./bs.js":"aqvp","./ca":"wIgY","./ca.js":"wIgY","./cs":"ssxj","./cs.js":"ssxj","./cv":"N3vo","./cv.js":"N3vo","./cy":"ZFGz","./cy.js":"ZFGz","./da":"YBA/","./da.js":"YBA/","./de":"DOkx","./de-at":"8v14","./de-at.js":"8v14","./de-ch":"Frex","./de-ch.js":"Frex","./de.js":"DOkx","./dv":"rIuo","./dv.js":"rIuo","./el":"CFqe","./el.js":"CFqe","./en-au":"Sjoy","./en-au.js":"Sjoy","./en-ca":"Tqun","./en-ca.js":"Tqun","./en-gb":"hPuz","./en-gb.js":"hPuz","./en-ie":"ALEw","./en-ie.js":"ALEw","./en-il":"QZk1","./en-il.js":"QZk1","./en-in":"yJfC","./en-in.js":"yJfC","./en-nz":"dyB6","./en-nz.js":"dyB6","./en-sg":"NYST","./en-sg.js":"NYST","./eo":"Nd3h","./eo.js":"Nd3h","./es":"LT9G","./es-do":"7MHZ","./es-do.js":"7MHZ","./es-mx":"USNP","./es-mx.js":"USNP","./es-us":"INcR","./es-us.js":"INcR","./es.js":"LT9G","./et":"XlWM","./et.js":"XlWM","./eu":"sqLM","./eu.js":"sqLM","./fa":"2pmY","./fa.js":"2pmY","./fi":"nS2h","./fi.js":"nS2h","./fil":"rMbQ","./fil.js":"rMbQ","./fo":"OVPi","./fo.js":"OVPi","./fr":"tzHd","./fr-ca":"bXQP","./fr-ca.js":"bXQP","./fr-ch":"VK9h","./fr-ch.js":"VK9h","./fr.js":"tzHd","./fy":"g7KF","./fy.js":"g7KF","./ga":"U5Iz","./ga.js":"U5Iz","./gd":"nLOz","./gd.js":"nLOz","./gl":"FuaP","./gl.js":"FuaP","./gom-deva":"VGQH","./gom-deva.js":"VGQH","./gom-latn":"+27R","./gom-latn.js":"+27R","./gu":"rtsW","./gu.js":"rtsW","./he":"Nzt2","./he.js":"Nzt2","./hi":"ETHv","./hi.js":"ETHv","./hr":"V4qH","./hr.js":"V4qH","./hu":"xne+","./hu.js":"xne+","./hy-am":"GrS7","./hy-am.js":"GrS7","./id":"yRTJ","./id.js":"yRTJ","./is":"upln","./is.js":"upln","./it":"FKXc","./it-ch":"/E8D","./it-ch.js":"/E8D","./it.js":"FKXc","./ja":"ORgI","./ja.js":"ORgI","./jv":"JwiF","./jv.js":"JwiF","./ka":"RnJI","./ka.js":"RnJI","./kk":"j+vx","./kk.js":"j+vx","./km":"5j66","./km.js":"5j66","./kn":"gEQe","./kn.js":"gEQe","./ko":"eBB/","./ko.js":"eBB/","./ku":"kI9l","./ku.js":"kI9l","./ky":"6cf8","./ky.js":"6cf8","./lb":"z3hR","./lb.js":"z3hR","./lo":"nE8X","./lo.js":"nE8X","./lt":"/6P1","./lt.js":"/6P1","./lv":"jxEH","./lv.js":"jxEH","./me":"svD2","./me.js":"svD2","./mi":"gEU3","./mi.js":"gEU3","./mk":"Ab7C","./mk.js":"Ab7C","./ml":"oo1B","./ml.js":"oo1B","./mn":"CqHt","./mn.js":"CqHt","./mr":"5vPg","./mr.js":"5vPg","./ms":"ooba","./ms-my":"G++c","./ms-my.js":"G++c","./ms.js":"ooba","./mt":"oCzW","./mt.js":"oCzW","./my":"F+2e","./my.js":"F+2e","./nb":"FlzV","./nb.js":"FlzV","./ne":"/mhn","./ne.js":"/mhn","./nl":"3K28","./nl-be":"Bp2f","./nl-be.js":"Bp2f","./nl.js":"3K28","./nn":"C7av","./nn.js":"C7av","./oc-lnc":"KOFO","./oc-lnc.js":"KOFO","./pa-in":"pfs9","./pa-in.js":"pfs9","./pl":"7LV+","./pl.js":"7LV+","./pt":"ZoSI","./pt-br":"AoDM","./pt-br.js":"AoDM","./pt.js":"ZoSI","./ro":"wT5f","./ro.js":"wT5f","./ru":"ulq9","./ru.js":"ulq9","./sd":"fW1y","./sd.js":"fW1y","./se":"5Omq","./se.js":"5Omq","./si":"Lgqo","./si.js":"Lgqo","./sk":"OUMt","./sk.js":"OUMt","./sl":"2s1U","./sl.js":"2s1U","./sq":"V0td","./sq.js":"V0td","./sr":"f4W3","./sr-cyrl":"c1x4","./sr-cyrl.js":"c1x4","./sr.js":"f4W3","./ss":"7Q8x","./ss.js":"7Q8x","./sv":"Fpqq","./sv.js":"Fpqq","./sw":"DSXN","./sw.js":"DSXN","./ta":"+7/x","./ta.js":"+7/x","./te":"Nlnz","./te.js":"Nlnz","./tet":"gUgh","./tet.js":"gUgh","./tg":"5SNd","./tg.js":"5SNd","./th":"XzD+","./th.js":"XzD+","./tk":"+WRH","./tk.js":"+WRH","./tl-ph":"3LKG","./tl-ph.js":"3LKG","./tlh":"m7yE","./tlh.js":"m7yE","./tr":"k+5o","./tr.js":"k+5o","./tzl":"iNtv","./tzl.js":"iNtv","./tzm":"FRPF","./tzm-latn":"krPU","./tzm-latn.js":"krPU","./tzm.js":"FRPF","./ug-cn":"To0v","./ug-cn.js":"To0v","./uk":"ntHu","./uk.js":"ntHu","./ur":"uSe8","./ur.js":"uSe8","./uz":"XU1s","./uz-latn":"/bsm","./uz-latn.js":"/bsm","./uz.js":"XU1s","./vi":"0X8Q","./vi.js":"0X8Q","./x-pseudo":"e/KL","./x-pseudo.js":"e/KL","./yo":"YXlc","./yo.js":"YXlc","./zh-cn":"Vz2w","./zh-cn.js":"Vz2w","./zh-hk":"ZUyn","./zh-hk.js":"ZUyn","./zh-mo":"+WA1","./zh-mo.js":"+WA1","./zh-tw":"BbgG","./zh-tw.js":"BbgG"};function r(t){return s(a(t))}function a(t){var e=n[t];if(!(e+1))throw new Error("Cannot find module '"+t+"'.");return e}r.keys=function(){return Object.keys(n)},r.resolve=a,t.exports=r,r.id="uslO"},xHZh:function(t,e){}},["NHnr"]);
//# sourceMappingURL=app.5801d911f175027b2deb.js.map